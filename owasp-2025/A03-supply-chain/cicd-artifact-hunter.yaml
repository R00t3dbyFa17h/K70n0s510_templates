id: K70n0s510-cicd-artifacts
info:
  name: CI/CD Build Log & Artifact Exposure
  author: K70n0s510
  severity: high
  description: Hunts for exposed build logs and artifacts (Jenkins, TeamCity, CircleCI) that contain secrets.
http:
  - method: GET
    path:
      # Jenkins: The "Holy Grail" of leaks (Console Output)
      - "{{BaseURL}}/job/{{HostName}}/lastBuild/consoleText"
      - "{{BaseURL}}/job/build/lastBuild/consoleText"
      
      # TeamCity: Unauthenticated Guest Access to Artifacts
      - "{{BaseURL}}/guestAuth/app/rest/builds"
      - "{{BaseURL}}/guestAuth/repository/download/build_id/.lastFinished/artifacts.zip"
      
      # GitLab: Public Job Artifacts
      - "{{BaseURL}}/api/v4/projects/1/jobs/artifacts"
      - "{{BaseURL}}/ci/api/v1/artifacts"
      
      # CircleCI: Exposed Configs
      - "{{BaseURL}}/.circleci/config.yml"
      - "{{BaseURL}}/circle.yml"

    matchers-condition: or
    matchers:
      - type: word
        name: jenkins-secrets
        words:
          - "Finished: SUCCESS"
          - "Finished: FAILURE"
          - "+ echo"  # Often shows echo'd secrets in logs
          - "AWS_ACCESS_KEY"
      - type: word
        name: teamcity-guest
        words:
          - '<builds count="'
          - "guestAuth"
      - type: status
        status:
          - 200
