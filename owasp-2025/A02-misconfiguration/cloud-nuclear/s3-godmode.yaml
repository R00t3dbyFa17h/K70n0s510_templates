id: K70n0s510-s3-godmode
info:
  name: AWS S3 Bucket Takeover (Strict)
  author: K70n0s510
  severity: high
  tags: s3,aws,takeover
http:
  - method: GET
    path:
      - "http://{{Host}}.s3.amazonaws.com"
      - "http://s3.amazonaws.com/{{Host}}"
    matchers-condition: and
    matchers:
      - type: word
        words: ["The specified bucket does not exist"]
      # STRICTER CHECK: Only fire if we don't see Cloudflare headers (implies direct AWS connection)
      - type: word
        part: header
        words: ["Server: Cloudflare", "cf-ray"]
        negative: true
