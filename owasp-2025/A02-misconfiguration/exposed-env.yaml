id: K70n0s510-mega-secrets
info:
  name: Mega-Secrets Exposure (Steroids Edition)
  author: K70n0s510
  severity: critical
  description: Path-spraying for env files with 50+ regex patterns for high-value secrets.
http:
  - method: GET
    path:
      - "{{BaseURL}}/.env"
      - "{{BaseURL}}/.env.production"
      - "{{BaseURL}}/.env.local"
      - "{{BaseURL}}/.env.backup"
      - "{{BaseURL}}/.env.save"
      - "{{BaseURL}}/docker-compose.yml"
      - "{{BaseURL}}/config.json"
      - "{{BaseURL}}/settings.py"

    matchers-condition: or
    matchers:
      - type: regex
        name: aws-access-key
        regex:
          - "(A3T[A-Z0-9]|AKIA|AGPA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}"
      - type: regex
        name: google-api-key
        regex:
          - "AIza[0-9A-Za-z\-_]{35}"
      - type: regex
        name: slack-token
        regex:
          - "(xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})"
      - type: regex
        name: stripe-key
        regex:
          - "(sk_live_[0-9a-zA-Z]{24})"
      - type: regex
        name: private-key-header
        regex:
          - "-----BEGIN ((EC|PGP|DSA|RSA|OPENSSH) )?PRIVATE KEY( BLOCK)?-----"
