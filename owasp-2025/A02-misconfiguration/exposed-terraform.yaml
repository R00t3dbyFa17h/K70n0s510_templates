id: K70n0s510-terraform-state
info:
  name: Exposed Terraform State (Path Spray)
  author: K70n0s510
  severity: critical
  description: Hunts for .tfstate files in root and hidden subdirectories.
http:
  - method: GET
    path:
      - "{{BaseURL}}/terraform.tfstate"
      - "{{BaseURL}}/.terraform/terraform.tfstate"
      - "{{BaseURL}}/terraform.tfstate.backup"
      - "{{BaseURL}}/tf/terraform.tfstate"
      - "{{BaseURL}}/prod/terraform.tfstate"
      - "{{BaseURL}}/dev/terraform.tfstate"
      - "{{BaseURL}}/backend.tf"
      - "{{BaseURL}}/.terraform.lock.hcl"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '"version":'
          - '"terraform_version":'
          - '"serial":'
          - '"lineage":'
      - type: status
        status:
          - 200
