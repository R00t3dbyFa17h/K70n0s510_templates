id: K70n0s510-s3-takeover
info:
  name: AWS S3 Bucket Takeover (Strict)
  author: K70n0s510
  severity: critical
  description: Detects open S3 buckets. Ignores WAF blocks.
http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "https://s3.amazonaws.com/{{HostName}}"
      - "https://{{HostName}}.s3.amazonaws.com"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<ListBucketResult"
          - "<Name>{{HostName}}</Name>"
          - "<Key>"

      - type: word
        words:
          - "Access Denied"
          - "AkamaiGHost"
        part: body
        negative: true
