id: K70n0s510-reset-enum
info:
  name: Password Reset User Enumeration
  author: K70n0s510
  severity: medium
  description: Detects if the password reset page reveals valid users via error messages.
  tags: a04,logic,auth
http:
  - method: POST
    path:
      - "{{BaseURL}}/password/reset"
      - "{{BaseURL}}/forgot-password"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "email=admin@{{Host}}"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "email sent"
          - "check your inbox"
      # WAF FIX: Ensure we aren't just seeing a WAF block page
      - type: word
        words:
          - "user not found"
          - "invalid email"
          - "Access Denied"
          - "AkamaiGHost"
        negative: true
