id: K70n0s510-weak-2fa
info:
  name: Weak 2FA Implementation
  author: K70n0s510
  severity: medium
  tags: a07,2fa
http:
  - method: POST
    path:
      - "{{BaseURL}}/api/2fa/verify"
    body: "code=000000"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "invalid code"
      # WAF FIX: Ignore WAF blocks and Rate Limits
      - type: word
        words:
          - "Rate limit exceeded"
          - "Access Denied"
          - "AkamaiGHost"
        negative: true
