id: liferay-headless-rce

info:
  name: Liferay Portal 7.3 - Headless Admin Workflow RCE
  author: R00t3dbyFa17h
  severity: critical
  description: Detects exposed Liferay Headless Admin Workflow API or Version 7.3.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-38002
  tags: liferay, rce, nasa

requests:
  - method: GET
    path:
      - "{{BaseURL}}/o/headless-admin-workflow/v1.0/workflow-definitions"
      - "{{BaseURL}}/o/js/liferay.js"

    stop-at-first-match: true

    matchers-condition: or
    matchers:
      # Matcher 1: API Check (Using DSL to combine Status + Body)
      - type: dsl
        dsl:
          - "status_code == 200 && contains(body, 'workflowDefinitionId') && contains(body, 'items')"

      # Matcher 2: Version Check
      - type: word
        part: body
        words:
          - "Athanasius"
          - "7.3.x"
        condition: and